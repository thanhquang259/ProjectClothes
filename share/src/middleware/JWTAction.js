'use strict';function _0x54ac(_0x362a53,_0x56095b){var _0x532b60=_0x532b();return _0x54ac=function(_0x54ac67,_0x1cb6c3){_0x54ac67=_0x54ac67-0xe5;var _0x4d7933=_0x532b60[_0x54ac67];return _0x4d7933;},_0x54ac(_0x362a53,_0x56095b);}function _0x532b(){var _0x5c35d1=['email','config','../models/index','945780KbKlaP','2656pafuaF','includes','some','Not\x20authenticated\x20the\x20user\x20.\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20','/refresh-token','cookies','/participant','NYtfc','JWT_SECRET','user','1414746TkTSXM','default','Token\x20Expired\x20Error.\x20You\x20need\x20to\x20use\x20Refresh_Token','/login','authorization','lodash','10611jCPHmi','TokenExpiredError','headers','length','/account','body','Bearer','bcryptjs','dotenv','env','Roles','__esModule','1051155FOVTfA','status','/register','path','295qZMyIt','split','925953FcqPOh','json','4104xQgPCS','/participant/all','access_token','iOPyu','/logout','you\x20don\x27t\x20permission\x20to\x20access\x20this\x20resource...','delay','836260zjduXJ'];_0x532b=function(){return _0x5c35d1;};return _0x532b();}var _0x3ffc20=_0x54ac;(function(_0x38d15d,_0x93d75){var _0x48fdd4=_0x54ac,_0x1d02a5=_0x38d15d();while(!![]){try{var _0x4d51e3=parseInt(_0x48fdd4(0x108))/0x1*(-parseInt(_0x48fdd4(0xe8))/0x2)+-parseInt(_0x48fdd4(0x10a))/0x3+parseInt(_0x48fdd4(0xe7))/0x4+parseInt(_0x48fdd4(0x113))/0x5+-parseInt(_0x48fdd4(0xf2))/0x6+parseInt(_0x48fdd4(0x104))/0x7+parseInt(_0x48fdd4(0x10c))/0x8*(parseInt(_0x48fdd4(0xf8))/0x9);if(_0x4d51e3===_0x93d75)break;else _0x1d02a5['push'](_0x1d02a5['shift']());}catch(_0x4b9508){_0x1d02a5['push'](_0x1d02a5['shift']());}}}(_0x532b,0x36517));var _jsonwebtoken=_interopRequireDefault(require('jsonwebtoken')),_lodash=require(_0x3ffc20(0xf7)),_uuid=require('uuid'),_index=_interopRequireDefault(require(_0x3ffc20(0xe6))),_bcryptjs=_interopRequireDefault(require(_0x3ffc20(0xff)));function _interopRequireDefault(_0x1f06b7){var _0x5d28ba=_0x3ffc20;return _0x1f06b7&&_0x1f06b7[_0x5d28ba(0x103)]?_0x1f06b7:{'default':_0x1f06b7};}require(_0x3ffc20(0x100))[_0x3ffc20(0xe5)]();var nonSecurePaths=[_0x3ffc20(0x110),_0x3ffc20(0xf5),_0x3ffc20(0x106),_0x3ffc20(0xec),_0x3ffc20(0xee),_0x3ffc20(0x10d)],verifyToken=function(_0x13f17f){var _0x292831=_0x3ffc20,_0x230f4f=process[_0x292831(0x101)][_0x292831(0xf0)],_0xc64f6e=null;try{if('SppND'!=='SppND'){if(_0x14ab32 instanceof _0x5b84d8[_0x292831(0xf3)]['TokenExpiredError'])return _0x292831(0xf9);}else _0xc64f6e=_jsonwebtoken[_0x292831(0xf3)]['verify'](_0x13f17f,_0x230f4f);}catch(_0x1b2e59){if(_0x292831(0x10f)!==_0x292831(0xef)){if(_0x1b2e59 instanceof _jsonwebtoken[_0x292831(0xf3)][_0x292831(0xf9)])return _0x292831(0xf9);}else{var _0x46589c;null!=_0x4fabd7&&null!=(_0x46589c=_0x1bf570[_0x292831(0xfd)])&&_0x46589c['delay']?_0x3f051a(function(){_0x493977();},+_0x5a34b0[_0x292831(0xfd)][_0x292831(0x112)]):_0x3dd973();}}return _0xc64f6e;},extractToken=function(_0x5dc48e){var _0x41e9a8=_0x3ffc20;return _0x5dc48e[_0x41e9a8(0xfa)][_0x41e9a8(0xf6)]&&_0x41e9a8(0xfe)===_0x5dc48e[_0x41e9a8(0xfa)][_0x41e9a8(0xf6)]['split']('\x20')[0x0]?_0x5dc48e[_0x41e9a8(0xfa)][_0x41e9a8(0xf6)][_0x41e9a8(0x109)]('\x20')[0x1]:null;},checkUserJWT=function(_0x378a03,_0x1249a8,_0x100e30){var _0xa5def5=_0x3ffc20;if(nonSecurePaths[_0xa5def5(0xe9)](_0x378a03[_0xa5def5(0x107)]))return _0x100e30();var _0x70103d=_0x378a03[_0xa5def5(0xed)],_0x340e6b=extractToken(_0x378a03);return _0x70103d&&_0x70103d[_0xa5def5(0x10e)]||_0x340e6b?(_0x70103d=_0x70103d&&_0x70103d[_0xa5def5(0x10e)]?_0x70103d['access_token']:_0x340e6b,(_0x340e6b=verifyToken(_0x70103d))&&_0xa5def5(0xf9)!==_0x340e6b?(_0x378a03['user']=_0x340e6b,void _0x100e30()):_0x340e6b&&_0xa5def5(0xf9)===_0x340e6b?_0x1249a8[_0xa5def5(0x105)](0x195)[_0xa5def5(0x10b)]({'EC':-0x3e7,'DT':'','EM':_0xa5def5(0xf4)}):_0x1249a8[_0xa5def5(0x105)](0x191)['json']({'EC':-0x1,'DT':'','EM':_0xa5def5(0xeb)})):_0x1249a8[_0xa5def5(0x105)](0x191)[_0xa5def5(0x10b)]({'EC':-0x1,'DT':'','EM':_0xa5def5(0xeb)});},checkUserPermission=function(_0x4ee510,_0x1919e0,_0x1fdbb5){var _0x2feae3=_0x3ffc20;return nonSecurePaths[_0x2feae3(0xe9)](_0x4ee510[_0x2feae3(0x107)])||_0x2feae3(0xfc)===_0x4ee510['path']?_0x1fdbb5():_0x4ee510[_0x2feae3(0xf1)]?(_0x4ee510['user'][_0x2feae3(0x114)],_0x294f35=_0x4ee510[_0x2feae3(0xf1)]['groupWithRoles'][_0x2feae3(0x102)],_0x504790=_0x4ee510['path'],!_0x294f35||0x0===_0x294f35[_0x2feae3(0xfb)]||!0x0!==_0x294f35[_0x2feae3(0xea)](function(_0x3c3dd7){var _0x2d25ff=_0x2feae3;return _0x3c3dd7['url']===_0x504790||_0x504790[_0x2d25ff(0xe9)](_0x3c3dd7['url']);})?_0x1919e0[_0x2feae3(0x105)](0x193)[_0x2feae3(0x10b)]({'EC':-0x1,'DT':'','EM':_0x2feae3(0x111)}):void _0x1fdbb5()):_0x1919e0[_0x2feae3(0x105)](0x191)[_0x2feae3(0x10b)]({'EC':-0x1,'DT':'','EM':_0x2feae3(0xeb)});var _0x294f35,_0x504790;},addDelay=function(_0x18dd5e,_0x55fd12,_0x534691){var _0x7852bc=_0x3ffc20,_0x4f52fb;null!=_0x18dd5e&&null!=(_0x4f52fb=_0x18dd5e[_0x7852bc(0xfd)])&&_0x4f52fb['delay']?setTimeout(function(){_0x534691();},+_0x18dd5e[_0x7852bc(0xfd)]['delay']):_0x534691();};module['exports']={'checkUserJWT':checkUserJWT,'checkUserPermission':checkUserPermission,'addDelay':addDelay};